{% extends "base.html" %}

{% block title %}PhÃ¢n tÃ­ch dá»¯ liá»‡u phim - Movie Data Analytics{% endblock %}

{% block content %}
<section class="data-header">
    <div class="container section-header">
        <p class="eyebrow">Data Analytics</p>
        <h1>PhÃ¢n tÃ­ch dá»¯ liá»‡u Ä‘iá»‡n áº£nh toÃ n cáº§u</h1>
        <p>KhÃ¡m phÃ¡ insights tá»« dataset {{ stats.total_movies }} bá»™ phim tá»« nhiá»u quá»‘c gia thÃ´ng qua biá»ƒu Ä‘á»“ trá»±c quan</p>
        
        <!-- Data Quality Explanation -->
        <div class="data-quality-info" style="background: rgba(139, 92, 246, 0.1); border-left: 4px solid #8b5cf6; padding: 20px; margin: 30px 0; border-radius: 8px;">
            <h3 style="color: #8b5cf6; margin-top: 0; font-size: 1.2rem;">ğŸ“Š Vá» dataset phÃ¢n tÃ­ch</h3>
            <p style="color: #c5c7d4; line-height: 1.8; margin: 10px 0;">
                <strong style="color: #fff;">Dataset gá»‘c:</strong> 2,193 bá»™ phim tá»« nhiá»u quá»‘c gia Ä‘Ã£ chiáº¿u táº¡i Viá»‡t Nam (1990-2024)<br>
                <strong style="color: #fff;">Dataset phÃ¢n tÃ­ch:</strong> 1,018 bá»™ phim (46.4% dataset gá»‘c)<br>
                <strong style="color: #fff;">Bá»‹ loáº¡i bá»:</strong> 1,175 bá»™ phim (53.6%) do thiáº¿u dá»¯ liá»‡u quan trá»ng
            </p>
            <details style="margin-top: 15px; cursor: pointer;">
                <summary style="color: #a855f7; font-weight: 600; cursor: pointer; user-select: none;">â“ Táº¡i sao loáº¡i bá» hÆ¡n 50% dá»¯ liá»‡u? (Click Ä‘á»ƒ xem chi tiáº¿t)</summary>
                <div style="margin-top: 15px; padding-left: 20px; border-left: 2px solid rgba(139, 92, 246, 0.3);">
                    <p style="color: #c5c7d4; line-height: 1.8;">
                        <strong style="color: #fff;">LÃ½ do khoa há»c:</strong> Äá»ƒ Ä‘áº£m báº£o cháº¥t lÆ°á»£ng phÃ¢n tÃ­ch vÃ  model ML, chÃºng tÃ´i chá»‰ sá»­ dá»¥ng phim cÃ³ Ä‘áº§y Ä‘á»§ thÃ´ng tin:
                    </p>
                    <ul style="color: #c5c7d4; line-height: 1.8; margin: 10px 0;">
                        <li><strong style="color: #e74c3c;">774 phim</strong> khÃ´ng cÃ³ dá»¯ liá»‡u <strong>Revenue</strong> (doanh thu) â†’ KhÃ´ng thá»ƒ tÃ­nh ROI vÃ  Ä‘Ã¡nh giÃ¡ thÃ nh cÃ´ng tÃ i chÃ­nh</li>
                        <li><strong style="color: #e74c3c;">399 phim</strong> khÃ´ng cÃ³ dá»¯ liá»‡u <strong>Budget</strong> (ngÃ¢n sÃ¡ch) â†’ KhÃ´ng thá»ƒ tÃ­nh ROI = Revenue/Budget (chia cho 0)</li>
                        <li><strong style="color: #e74c3c;">2 phim</strong> khÃ´ng cÃ³ <strong>Vote Average</strong> â†’ KhÃ´ng thá»ƒ Ä‘Ã¡nh giÃ¡ cháº¥t lÆ°á»£ng ná»™i dung</li>
                    </ul>
                    <p style="color: #27ae60; font-weight: 600; margin-top: 15px;">
                        âœ… Káº¿t quáº£: 1,018 phim cÃ³ Ä‘áº§y Ä‘á»§ Budget, Revenue, Runtime, Vote Average - Ä‘á»§ Ä‘á»ƒ train model ML chÃ­nh xÃ¡c!
                    </p>
                </div>
            </details>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-number">{{ stats.total_movies }}</span>
                <span class="stat-label">Phim phÃ¢n tÃ­ch</span>
                <span class="stat-sublabel" style="font-size: 0.75rem; color: #a855f7;">Tá»« 2,193 phim gá»‘c</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ "%.1f"|format(stats.success_rate) }}%</span>
                <span class="stat-label">Tá»· lá»‡ thÃ nh cÃ´ng</span>
                <span class="stat-sublabel" style="font-size: 0.75rem; color: #27ae60;">ROIâ‰¥1 & Voteâ‰¥6.5</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">${{ "{:,.0f}".format(stats.avg_budget) }}</span>
                <span class="stat-label">NgÃ¢n sÃ¡ch TB</span>
                <span class="stat-sublabel" style="font-size: 0.75rem; color: #3498db;">Trung bÃ¬nh toÃ n cáº§u</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ "%.1f"|format(stats.avg_vote) }}</span>
                <span class="stat-label">Äiá»ƒm Ä‘Ã¡nh giÃ¡ TB</span>
                <span class="stat-sublabel" style="font-size: 0.75rem; color: #e67e22;">Thang Ä‘iá»ƒm 10</span>
            </div>
        </div>
    </div>
</section>

<section class="data-visualizations">
    <div class="container">
        <div class="chart-grid">
            <!-- Budget Distribution -->
            <div class="chart-card">
                <h3>ğŸ“Š PhÃ¢n bá»‘ ngÃ¢n sÃ¡ch sáº£n xuáº¥t</h3>
                <div class="chart-container">
                    {{ budget_dist|safe }}
                </div>
                <p class="chart-description">
                    PhÃ¢n bá»‘ ngÃ¢n sÃ¡ch Ä‘a dáº¡ng tá»« indie films Ä‘áº¿n blockbusters, pháº£n Ã¡nh thá»‹ trÆ°á»ng Ä‘iá»‡n áº£nh toÃ n cáº§u.
                </p>
            </div>

            <!-- Vote Average Distribution -->
            <div class="chart-card">
                <h3>â­ PhÃ¢n bá»‘ Ä‘iá»ƒm Ä‘Ã¡nh giÃ¡</h3>
                <div class="chart-container">
                    {{ vote_dist|safe }}
                </div>
                <p class="chart-description">
                    Äiá»ƒm Ä‘Ã¡nh giÃ¡ táº­p trung chá»§ yáº¿u tá»« 5.5 Ä‘áº¿n 7.5, cho tháº¥y cháº¥t lÆ°á»£ng phim tÆ°Æ¡ng Ä‘á»‘i Ä‘á»“ng Ä‘á»u trÃªn toÃ n cáº§u.
                </p>
            </div>

            <!-- Budget vs Revenue Scatter -->
            <div class="chart-card chart-full">
                <h3>ğŸ’° Má»‘i quan há»‡ NgÃ¢n sÃ¡ch - Doanh thu</h3>
                <div class="chart-container">
                    {{ budget_revenue|safe }}
                </div>
                <p class="chart-description">
                    MÃ u xanh lÃ¡: Phim thÃ nh cÃ´ng (ROI â‰¥1 & Vote â‰¥6.5), MÃ u Ä‘á»: Phim khÃ´ng thÃ nh cÃ´ng.
                    CÃ¡c Ä‘iá»ƒm á»Ÿ trÃªn Ä‘Æ°á»ng chÃ©o cho tháº¥y phim cÃ³ lÃ£i.
                </p>
            </div>

            <!-- Genre Distribution -->
            <div class="chart-card">
                <h3>ğŸ­ Thá»ƒ loáº¡i phim phá»• biáº¿n</h3>
                <div class="chart-container">
                    {{ genre_dist|safe }}
                </div>
                <p class="chart-description">
                    Drama lÃ  thá»ƒ loáº¡i phá»• biáº¿n nháº¥t trÃªn toÃ n cáº§u, theo sau bá»Ÿi Action, Comedy vÃ  Thriller.
                </p>
            </div>

            <!-- Runtime Distribution -->
            <div class="chart-card">
                <h3>â±ï¸ PhÃ¢n bá»‘ thá»i lÆ°á»£ng phim</h3>
                <div class="chart-container">
                    {{ runtime_dist|safe }}
                </div>
                <p class="chart-description">
                    Háº§u háº¿t cÃ¡c phim cÃ³ thá»i lÆ°á»£ng tá»« 90-120 phÃºt, phÃ¹ há»£p vá»›i Ä‘á»‹nh dáº¡ng phim truyá»‡n.
                </p>
            </div>

            <!-- Yearly Trends -->
            <div class="chart-card chart-full">
                <h3>ğŸ“ˆ Xu hÆ°á»›ng sáº£n xuáº¥t vÃ  thÃ nh cÃ´ng theo nÄƒm</h3>
                <div class="chart-container">
                    {{ yearly_trend|safe }}
                </div>
                <p class="chart-description">
                    Sá»‘ lÆ°á»£ng phim sáº£n xuáº¥t vÃ  tá»· lá»‡ thÃ nh cÃ´ng thay Ä‘á»•i theo thá»i gian. Dá»¯ liá»‡u tá»« {{ stats.year_range }}.
                </p>
            </div>

            <!-- Vote Analysis -->
            <div class="chart-card chart-full">
                <h3>ğŸ“Š PhÃ¢n tÃ­ch Ä‘Ã¡nh giÃ¡ chi tiáº¿t</h3>
                <div class="chart-container">
                    {{ vote_analysis|safe }}
                </div>
                <p class="chart-description">
                    Má»‘i quan há»‡ giá»¯a sá»‘ lÆ°á»£ng ngÆ°á»i Ä‘Ã¡nh giÃ¡ vÃ  Ä‘iá»ƒm trung bÃ¬nh. Phim thÃ nh cÃ´ng thÆ°á»ng cÃ³ nhiá»u Ä‘Ã¡nh giÃ¡ hÆ¡n.
                </p>
            </div>

            <!-- ROI Distribution -->
            <div class="chart-card chart-full">
                <h3>ğŸ’¸ PhÃ¢n bá»‘ tá»· suáº¥t lá»£i nhuáº­n (ROI)</h3>
                <div class="chart-container">
                    {{ roi_dist|safe }}
                </div>
                <p class="chart-description">
                    ROI Ã¢m (< 0%) = thua lá»—, ROI dÆ°Æ¡ng (> 0%) = lÃ£i. ÄÆ°á»ng Ä‘á»©t nÃ©t Ä‘á» lÃ  Ä‘iá»ƒm hÃ²a vá»‘n.
                </p>
            </div>
        </div>
    </div>
</section>

<section class="data-insights">
    <div class="container">
        <h2>ğŸ” Insights chÃ­nh tá»« dá»¯ liá»‡u</h2>
        <div class="insights-grid">
            <div class="insight-card">
                <h4>ğŸ¯ Yáº¿u tá»‘ quyáº¿t Ä‘á»‹nh thÃ nh cÃ´ng</h4>
                <ul>
                    <li><strong>ROI â‰¥ 1.0:</strong> Phim cÃ³ lá»£i nhuáº­n (thu há»“i vá»‘n Ä‘áº§u tÆ°)</li>
                    <li><strong>Vote Average â‰¥ 6.5:</strong> Äiá»ƒm Ä‘Ã¡nh giÃ¡ tá»‘t tá»« khÃ¡n giáº£</li>
                    <li>Thá»i lÆ°á»£ng phim tá»‘i Æ°u: 90-120 phÃºt</li>
                    <li>NgÃ¢n sÃ¡ch há»£p lÃ½, khÃ´ng quÃ¡ cao hoáº·c quÃ¡ tháº¥p</li>
                    <li>{{ stats.movies_with_profit }} phim cÃ³ lÃ£i / {{ stats.movies_with_loss }} phim lá»—</li>
                </ul>
            </div>
            <div class="insight-card">
                <h4>ğŸ“Š Thá»‘ng kÃª cháº¥t lÆ°á»£ng dá»¯ liá»‡u</h4>
                <ul>
                    <li><strong>Dataset gá»‘c:</strong> {{ stats.total_raw_movies }} bá»™ phim (1990-2024)</li>
                    <li><strong>Dataset phÃ¢n tÃ­ch:</strong> {{ stats.total_movies }} bá»™ phim ({{ "%.1f"|format(100 - stats.removal_percentage) }}%)</li>
                    <li><strong>ÄÃ£ loáº¡i bá»:</strong> {{ stats.removed_movies }} phim thiáº¿u dá»¯ liá»‡u quan trá»ng</li>
                    <li>{{ stats.genres_count }} thá»ƒ loáº¡i phim khÃ¡c nhau</li>
                    <li>ROI trung bÃ¬nh: {{ "%.2f"|format(stats.avg_roi) }}x ({{ "%.0f"|format((stats.avg_roi - 1) * 100) }}% lá»£i nhuáº­n)</li>
                    <li>Doanh thu TB: ${{ "{:,.0f}".format(stats.avg_revenue) }}</li>
                </ul>
            </div>
            <div class="insight-card">
                <h4>ğŸ’¡ Khuyáº¿n nghá»‹ cho nhÃ  sáº£n xuáº¥t</h4>
                <ul>
                    <li><strong>Cháº¥t lÆ°á»£ng > Sá»‘ lÆ°á»£ng:</strong> Táº­p trung vÃ o ná»™i dung tá»‘t hÆ¡n ngÃ¢n sÃ¡ch khá»§ng</li>
                    <li><strong>Thá»i Ä‘iá»ƒm phÃ¡t hÃ nh:</strong> Chá»n thÃ¡ng/nÄƒm phÃ¹ há»£p vá»›i thá»ƒ loáº¡i</li>
                    <li><strong>Marketing hiá»‡u quáº£:</strong> TÄƒng Vote Count Ä‘á»ƒ táº¡o buzz</li>
                    <li><strong>Há»c tá»« dá»¯ liá»‡u:</strong> PhÃ¢n tÃ­ch {{ stats.total_movies }} phim thÃ nh cÃ´ng/tháº¥t báº¡i</li>
                    <li><strong>Äáº£m báº£o ROI:</strong> {{ "%.1f"|format(stats.success_rate) }}% phim Ä‘áº¡t tiÃªu chÃ­ thÃ nh cÃ´ng</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<section class="data-actions">
    <div class="container">
        <div class="actions-grid">
            <a href="{{ url_for('home') }}#predict" class="btn">Dá»± Ä‘oÃ¡n phim má»›i</a>
            <a href="#data-header" class="btn-outline">Xem láº¡i biá»ƒu Ä‘á»“</a>
        </div>
    </div>
</section>
{% endblock %}